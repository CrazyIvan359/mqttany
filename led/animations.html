

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Animations &mdash; MQTTany v0.11.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Built-in" href="animations/built-in.html" />
    <link rel="prev" title="LED" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: navy" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MQTTany
          

          
          </a>

          
            
            
              <div class="version">
                v0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">MQTTany</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../launch.html">Launching</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CrazyIvan359/mqttany/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CrazyIvan359/mqttany/blob/dev/CHANGELOG.md">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mqtt/index.html">MQTT Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../mqtt/index.html#topics">Topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../mqtt/index.html#relative">Relative</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mqtt/index.html#absolute">Absolute</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mqtt/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mqtt/index.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpio/index.html">GPIO Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpio/index.html#supported-boards">Supported Boards</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpio/raspi.html">Raspberry Pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/odroid.html">Odroid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpio/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpio/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#single-pin-definition">Single Pin Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#multiple-pin-definition">Multiple Pin Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../i2c/index.html">I2C Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../i2c/index.html#devices">Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../i2c/devices/mcp230xx.html">MCP230xx</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../i2c/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i2c/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html#device-definition">Device Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../onewire/index.html">OneWire Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../onewire/index.html#devices">Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../onewire/devices/ds18x20.html">DS18x20</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../onewire/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../onewire/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../onewire/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onewire/index.html#single-device-definition">Single Device Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../onewire/index.html#multiple-device-definition">Multiple Device Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">LED Module</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Animations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="animations/built-in.html">Built-in</a></li>
<li class="toctree-l3"><a class="reference internal" href="animations/custom.html">Custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="#triggering">Triggering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#supported-interfaces">Supported Interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="interfaces/raspi.html">Raspberry Pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="interfaces/sacn.html">Streaming ACN</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#array-definition">Array Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../xset/index.html">XSET Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../xset/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../xset/index.html#module-settings">Module Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../xset/index.html#commands">Commands</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MQTTany</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">LED</a> &raquo;</li>
        
      <li>Animations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/led/animations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="animations">
<h1>Animations<a class="headerlink" href="#animations" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>Because of the real-time nature of controlling WS281x and similar LEDs, this
module does not provide direct control of them over MQTT. Instead it controls
them with special Python functions called <em>animations</em> that are triggered via
MQTT. There are a handful of built-in animations, and you can write any number
of custom animations for your application.</p>
<div class="section" id="triggering">
<h2>Triggering<a class="headerlink" href="#triggering" title="Permalink to this headline">¶</a></h2>
<p>Animations can be triggered by sending an MQTT message to any of 3 topics. The
message may be blank, depending on which topic you send it to, or contain some
parameters to modify the queuing and behavoir of the animation.</p>
<div class="section" id="message-content">
<h3>Message Content<a class="headerlink" href="#message-content" title="Permalink to this headline">¶</a></h3>
<p>If the message is not blank, it must be JSON data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;array&quot;</span><span class="p">:</span> <span class="s2">&quot;ARRAY_NAME&quot;</span><span class="p">,</span>      <span class="c1"># required for messages to module topic</span>
    <span class="s2">&quot;anim&quot;</span><span class="p">:</span> <span class="s2">&quot;ANIMATION_NAME&quot;</span><span class="p">,</span>   <span class="c1"># required for messages to module or array topic</span>
    <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;repeat&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;arg&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span>              <span class="c1"># any additional arguments for animation</span>
<span class="p">}</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">array</span></code></p></td>
<td><p>The name of the array to trigger the animation for.
Used only for messages to the module topic.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">anim</span></code></p></td>
<td><p>The name of the animation (<em>Ex.</em> <code class="docutils literal notranslate"><span class="pre">&quot;test.array&quot;</span></code>)
to trigger. Used for messages to the module topic or
array topic.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">priority</span></code></p></td>
<td><p>The priority with which to process the animation.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> run immediately, cancelling running animation
and skipping all queued animations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> add to queue and cancel only infinite-loop
(<code class="docutils literal notranslate"><span class="pre">repeat:</span> <span class="pre">0</span></code>) animations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> add to queue and wait until all animations
ahead of this one have finished. Note that priority
<code class="docutils literal notranslate"><span class="pre">0</span></code> animations sent to an array following an
animation with <code class="docutils literal notranslate"><span class="pre">repeat:</span> <span class="pre">0</span></code> will never be run.</p></li>
</ul>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">repeat</span></code></p></td>
<td><p>How many times to repeat the animation, can be any
positive integer, <code class="docutils literal notranslate"><span class="pre">0</span></code> means repeat infinitely
until cancelled.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">arg</span></code></p></td>
<td><p>Any other values will be passed to the animation
function when called.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-topic">
<h3>Module Topic<a class="headerlink" href="#module-topic" title="Permalink to this headline">¶</a></h3>
<p>You can send a JSON message to the module topic to trigger an animation, it
must contain the <cite>array</cite> and <cite>anim</cite> fields.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>topic: hostname/led
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;array&quot;</span><span class="p">:</span> <span class="s2">&quot;my_array&quot;</span><span class="p">,</span>
    <span class="s2">&quot;anim&quot;</span><span class="p">:</span> <span class="s2">&quot;test.array&quot;</span><span class="p">,</span>
    <span class="s2">&quot;repeat&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Will trigger the <code class="docutils literal notranslate"><span class="pre">test.array</span></code> animation for the array <code class="docutils literal notranslate"><span class="pre">my_array</span></code> with
priority <code class="docutils literal notranslate"><span class="pre">1</span></code> and repeat twice.</p>
</div>
<div class="section" id="array-topic">
<h3>Array Topic<a class="headerlink" href="#array-topic" title="Permalink to this headline">¶</a></h3>
<p>You can send a JSON message to the array’s topic, it must contain the <code class="docutils literal notranslate"><span class="pre">anim</span></code>
field. Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>topic: hostname/led/my_array
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;anim&quot;</span><span class="p">:</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span>
    <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above message will trigger the <code class="docutils literal notranslate"><span class="pre">off</span></code> animation for the array <code class="docutils literal notranslate"><span class="pre">my_array</span></code>
and cancel any running or queued animations ahead of it.</p>
</div>
<div class="section" id="array-animation-topic">
<h3>Array + Animation Topic<a class="headerlink" href="#array-animation-topic" title="Permalink to this headline">¶</a></h3>
<p>You can also send a message to the array’s topic plus the name of the
animation. This is the only time the message may be empty, if there are no
arguments and default options are desired. Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>topic: hostname/led/my_array/test.order
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Will trigger the <code class="docutils literal notranslate"><span class="pre">test.order</span></code> animation for the array <code class="docutils literal notranslate"><span class="pre">my_array</span></code> with the
defaults priority <code class="docutils literal notranslate"><span class="pre">1</span></code> and repeat <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="animations/built-in.html" class="btn btn-neutral float-right" title="Built-in" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="LED" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, MQTTany Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>