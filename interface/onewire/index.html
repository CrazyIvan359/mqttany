

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OneWire &mdash; MQTTany v0.13.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DS18x20" href="devices/ds18x20.html" />
    <link rel="prev" title="MCP230xx" href="../i2c/devices/mcp230xx.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> MQTTany
          

          
          </a>

          
            
            
              <div class="version">
                v0.13.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#paths">Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#ids">IDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../launch.html">Launching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../communication/index.html">Communication Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../communication/mqtt/index.html">MQTT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../communication/mqtt/index.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../communication/mqtt/index.html#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Interface Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../gpio/index.html">GPIO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#permissions">Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpio/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gpio/index.html#single-pin-definition">Single Pin Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gpio/index.html#multiple-pin-definition">Multiple Pin Definition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#supported-boards">Supported Boards</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpio/board/raspi.html">Raspberry Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gpio/board/odroid.html">Odroid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gpio/board/orangepi.html">Orange Pi</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpio/index.html#supported-pin-types">Supported Pin Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpio/pin/digital.html">Digital Pin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../gpio/pin/counter.html">Counter Pin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../i2c/index.html">I2C</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html#permissions">Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html#devices">Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../i2c/devices/mcp230xx.html">MCP230xx</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../i2c/index.html#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../i2c/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../i2c/index.html#device-definition">Device Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OneWire</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#permissions">Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#devices">Devices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="devices/ds18x20.html">DS18x20</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-settings">Module Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-device-definition">Single Device Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiple-device-definition">Multiple Device Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../led/index.html">LED</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../led/animations.html">Animations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../led/animations/built-in.html">Built-in</a></li>
<li class="toctree-l4"><a class="reference internal" href="../led/animations/custom.html">Custom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../led/animations.html#triggering">Triggering</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../led/index.html#supported-outputs">Supported Outputs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../led/outputs/raspi.html">Raspberry Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../led/outputs/sacn.html">Streaming ACN</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../led/index.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../led/index.html#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../led/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../led/index.html#array-definition">Array Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../xset/index.html">XSET</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../xset/index.html#paths">Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../xset/index.html#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../xset/index.html#module-settings">Module Settings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../xset/index.html#useful-xset-commands">Useful <code class="docutils literal notranslate"><span class="pre">xset</span></code> Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CrazyIvan359/mqttany/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CrazyIvan359/mqttany/blob/master/CHANGELOG.md">Change Log</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MQTTany</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Interface Modules</a> &raquo;</li>
        
      <li>OneWire</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/interface/onewire/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="onewire">
<h1>OneWire<a class="headerlink" href="#onewire" title="Permalink to this headline">¶</a></h1>
<p>The OneWire module provides access to Dallas/Maxim OneWire devices using the
<code class="docutils literal notranslate"><span class="pre">w1</span></code> kernel module.</p>
<div class="admonition-don-t-forget-to-install-the-requirements admonition">
<p class="admonition-title">Don’t forget to install the requirements</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install -r requirements/onewire.txt
</pre></div>
</div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>You need to have <code class="docutils literal notranslate"><span class="pre">wire-1</span></code> installed and configured for this module to work.
This process will vary based on the board and operatering system you are using.</p>
</div>
<div class="section" id="permissions">
<h2>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">udev</span></code> rule file is provided to simplify access permissions for <code class="docutils literal notranslate"><span class="pre">wire-1</span></code> devices.</p>
<p>First add the <code class="docutils literal notranslate"><span class="pre">wire</span></code> group if it does not exist and add the user running
MQTTany to the <code class="docutils literal notranslate"><span class="pre">wire</span></code> group:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo addgroup --system wire
sudo usermod -aG wire mqttany
</pre></div>
</div>
<p>Then install the <code class="docutils literal notranslate"><span class="pre">udev</span></code> rule and reboot:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo cp udev/98-w1.rules /etc/udev/rules.d/
sudo reboot now
</pre></div>
</div>
</div>
<div class="section" id="devices">
<h2>Devices<a class="headerlink" href="#devices" title="Permalink to this headline">¶</a></h2>
<p>See the device pages below for details on each one and to see any
additional options available for them.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="devices/ds18x20.html">DS18x20</a></li>
</ul>
</div>
</div>
<div class="section" id="paths">
<h2>Paths<a class="headerlink" href="#paths" title="Permalink to this headline">¶</a></h2>
<p>Device IDs are used as the nodes in this module, giving paths like
<code class="docutils literal notranslate"><span class="pre">{device-id}/{property-id}</span></code>. The device pages give more detail on the properties
they provide.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Path</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">onewire/polling-interval</span></code></p></td>
<td><p>The polling interval will be published here
with <code class="docutils literal notranslate"><span class="pre">retained</span> <span class="pre">=</span> <span class="pre">True</span></code> when the device is
started.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">onewire/poll-all/set</span></code></p></td>
<td><p>Sending any message (even blank) here will
poll all configured devices to publish their
current states.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">{device-id}/address</span></code></p></td>
<td><p>Device address will be published here with
<code class="docutils literal notranslate"><span class="pre">retained</span> <span class="pre">=</span> <span class="pre">True</span></code> when the device is started.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>Optional settings are commented out, default values are shown.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">onewire</span><span class="p">:</span>

  <span class="c1">#bus: &#39;w1&#39;</span>
  <span class="c1">#polling interval: 0</span>
  <span class="c1">#bus scan: false</span>

  <span class="nt">device-id</span><span class="p">:</span>
    <span class="nt">address</span><span class="p">:</span> <span class="s">&#39;&#39;</span>
    <span class="c1">#name: &#39;{device_id}&#39;</span>

  <span class="nt">batch-id</span><span class="p">:</span>
    <span class="nt">address</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;&#39;</span><span class="p p-Indicator">,</span> <span class="s">&#39;&#39;</span><span class="p p-Indicator">]</span>
    <span class="c1">#name: &#39;{device_id}&#39;</span>
    <span class="c1">#name: [  ]    # can also provide a matching list of names</span>
    <span class="c1">#first index: 0</span>
</pre></div>
</div>
<div class="section" id="module-settings">
<h3>Module Settings<a class="headerlink" href="#module-settings" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bus</span></code></p></td>
<td><p>OneWire bus interface, currently only <code class="docutils literal notranslate"><span class="pre">w1</span></code> is
supported.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">w1</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">polling</span> <span class="pre">interval</span></code></p></td>
<td><p>Interval in seconds to publish all pin states.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">60</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bus</span> <span class="pre">scan</span></code></p></td>
<td><p>Set to <code class="docutils literal notranslate"><span class="pre">true</span></code> to have the OneWire module scan the
bus for any devices that are not defined in the
configuration file. Any devices found will be added
with default options and their device topic set to
<code class="docutils literal notranslate"><span class="pre">{address}</span></code>.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="single-device-definition">
<h3>Single Device Definition<a class="headerlink" href="#single-device-definition" title="Permalink to this headline">¶</a></h3>
<p>Device configuration section names must be unique throughout the config file as they
are used as node IDs. Node IDs can only contain lowercase letters <code class="docutils literal notranslate"><span class="pre">a-z</span></code>, numbers
<code class="docutils literal notranslate"><span class="pre">0-9</span></code>, and hyphens <code class="docutils literal notranslate"><span class="pre">-</span></code>. The following settings are for single device definitions:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">address</span></code></p></td>
<td><p>The device’s address, can be 7 or 8 bytes, can use
<code class="docutils literal notranslate"><span class="pre">w1</span></code> style <code class="docutils literal notranslate"><span class="pre">xx-xxxxxxxxxxxx</span></code>.</p>
<p><strong>MUST BE IN SINGLE QUOTES</strong> <code class="docutils literal notranslate"><span class="pre">''</span></code>.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>Friendly name for the device.</p>
<p>Substitutions:</p>
<p><code class="docutils literal notranslate"><span class="pre">{device_id}</span></code> will be replaced with the device definition
section name.</p>
<p><code class="docutils literal notranslate"><span class="pre">{device_type}</span></code> will be replaced with the device type
(ex. <code class="docutils literal notranslate"><span class="pre">DS18B20</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">{address}</span></code> will be replaced with the device’s <strong>FULL 8 BYTE
ADDRESS</strong>.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">{device_id}</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="multiple-device-definition">
<h3>Multiple Device Definition<a class="headerlink" href="#multiple-device-definition" title="Permalink to this headline">¶</a></h3>
<p>It is also possible to define settings for several devices at the same time.
Settings from single device definitions apply here also, except for those
shown below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 79%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Option</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">address</span></code></p></td>
<td><p>Instead of a single address you can specify a list
of addresses.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>For multiple device definitions, name can be a single name or
a list of names the same length as the list of addresses.</p>
<p>An additional substitution <code class="docutils literal notranslate"><span class="pre">{index}</span></code> is available when
a list of pin numbers is given. It corresponds to the pin’s
index in the list plus <em>first index</em>.</p>
<p>If a single name is given and the substitution <code class="docutils literal notranslate"><span class="pre">{index}</span></code>
is not present, the name will have the index
appended to the end like <code class="docutils literal notranslate"><span class="pre">{name}</span> <span class="pre">{index}</span></code>.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">{device_name}</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">first</span> <span class="pre">index</span></code></p></td>
<td><p>Will be added to device’s index in the list of
addresses when subsituting <code class="docutils literal notranslate"><span class="pre">{index}</span></code> in topics.</p>
<p><em>Optional, default</em> <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="devices/ds18x20.html" class="btn btn-neutral float-right" title="DS18x20" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../i2c/devices/mcp230xx.html" class="btn btn-neutral float-left" title="MCP230xx" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2021, MQTTany Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>