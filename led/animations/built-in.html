

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Built-in &mdash; MQTTany 0.10.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Custom" href="custom.html" />
    <link rel="prev" title="Animations" href="../animations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: navy" >
          

          
            <a href="../../index.html" class="icon icon-home"> MQTTany
          

          
          </a>

          
            
            
              <div class="version">
                0.10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">MQTTany</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../launch.html">Launching</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CrazyIvan359/mqttany/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CrazyIvan359/mqttany/blob/dev/CHANGELOG.md">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mqtt/index.html">MQTT Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mqtt/index.html#topics">Topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../mqtt/index.html#relative">Relative</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mqtt/index.html#absolute">Absolute</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../mqtt/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mqtt/index.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../gpio/index.html">GPIO Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../gpio/index.html#supported-boards">Supported Boards</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../gpio/raspi.html">Raspberry Pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gpio/odroid.html">Odroid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../gpio/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gpio/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../gpio/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gpio/index.html#single-pin-definition">Single Pin Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gpio/index.html#multiple-pin-definition">Multiple Pin Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../i2c/index.html">I2C Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../i2c/index.html#devices">Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../i2c/devices/mcp230xx.html">MCP230xx</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../i2c/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../i2c/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../i2c/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../i2c/index.html#device-definition">Device Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../onewire/index.html">OneWire Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../onewire/index.html#devices">Devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../onewire/devices/ds18x20.html">DS18x20</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../onewire/index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../onewire/index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../onewire/index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../onewire/index.html#single-device-definition">Single Device Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../onewire/index.html#multiple-device-definition">Multiple Device Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">LED Module</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../animations.html">Animations</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Built-in</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom.html">Custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../animations.html#triggering">Triggering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#supported-interfaces">Supported Interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/raspi.html">Raspberry Pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../interfaces/sacn.html">Streaming ACN</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#substitutions">Substitutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index.html#module-settings">Module Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#array-definition">Array Definition</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MQTTany</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">LED</a> &raquo;</li>
        
          <li><a href="../animations.html">Animations</a> &raquo;</li>
        
      <li>Built-in</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/led/animations/built-in.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="built-in">
<h1>Built-in<a class="headerlink" href="#built-in" title="Permalink to this headline">¶</a></h1>
<p>Several animations are included in the module to cover some basic operations
and serve as examples to get you started writing your own animations.</p>
<div class="section" id="on">
<h2><code class="docutils literal notranslate"><span class="pre">on</span></code><a class="headerlink" href="#on" title="Permalink to this headline">¶</a></h2>
<p>This simply turns all channels on every LED to maximum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">anim_on</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">cancel</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns on the array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
        <span class="n">array</span><span class="o">.</span><span class="n">setPixelColorRGB</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
    <span class="n">array</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Here we are just iterating over all the LEDs in the array and setting their
RGBW values to maximum. <code class="docutils literal notranslate"><span class="pre">array.count</span></code> tells us how many pixels are in the
array.</p>
</div>
<div class="section" id="off">
<h2><code class="docutils literal notranslate"><span class="pre">off</span></code><a class="headerlink" href="#off" title="Permalink to this headline">¶</a></h2>
<p>This does the same the operation as <code class="docutils literal notranslate"><span class="pre">on</span></code> but sets all channels to <code class="docutils literal notranslate"><span class="pre">0</span></code> on
each pixel.</p>
</div>
<div class="section" id="set-brightness">
<h2><code class="docutils literal notranslate"><span class="pre">set.brightness</span></code><a class="headerlink" href="#set-brightness" title="Permalink to this headline">¶</a></h2>
<p>This sets the brightness value for the array and shows how to use an argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">anim_set_brightness</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">cancel</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the array brightness</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">brightness</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;brightness&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">brightness</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;set.brightness: Missing argument &#39;brightness&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">array</span><span class="o">.</span><span class="n">setBrightness</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">brightness</span><span class="p">))</span>
    <span class="n">array</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>As you can see above we are verifying that we got the <code class="docutils literal notranslate"><span class="pre">brightness</span></code> argument.
No argument checking is done by the LED module when calling animations, you
must do this in the animation function.</p>
<p>Example message to trigger this animation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;anim&quot;</span><span class="p">:</span> <span class="s2">&quot;brightness&quot;</span><span class="p">,</span>
    <span class="s2">&quot;brightness&quot;</span><span class="p">:</span> <span class="mi">128</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="set-array">
<h2><code class="docutils literal notranslate"><span class="pre">set.array</span></code><a class="headerlink" href="#set-array" title="Permalink to this headline">¶</a></h2>
<p>Allows you to set the entire array to a specific color. Repeat values other
than <code class="docutils literal notranslate"><span class="pre">1</span></code> have no effect. Color values can be provided as a list, a hex color,
or the individual components.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># As list of components</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="n">white</span><span class="p">]</span>

<span class="c1"># As hex string (prefix &#39;#&#39; or &#39;0x&#39;)</span>
    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;#RRGGBB&quot;</span> <span class="c1"># or &quot;#WWRRGGBB&quot;</span>

<span class="c1"># As color components, all optional with default 0</span>
    <span class="s2">&quot;red&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
    <span class="s2">&quot;green&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
    <span class="s2">&quot;blue&quot;</span><span class="p">:</span> <span class="mi">255</span><span class="p">,</span>
    <span class="s2">&quot;white&quot;</span><span class="p">:</span> <span class="mi">255</span>
</pre></div>
</div>
</div>
<div class="section" id="set-pixel">
<h2><code class="docutils literal notranslate"><span class="pre">set.pixel</span></code><a class="headerlink" href="#set-pixel" title="Permalink to this headline">¶</a></h2>
<p>Allows you to set a pixel or range of pixels to the specified color. Color
arguments are the same as <a class="reference internal" href="#set-array"><span class="std std-ref">set.array</span></a>,
the <code class="docutils literal notranslate"><span class="pre">pixel</span></code> argument may be a single pixel index, a range as string, or a
list of indices, ranges, 2-tuples of <em>[start, count]</em>, or any combination
thereof.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># single index</span>
    <span class="s2">&quot;pixel&quot;</span><span class="p">:</span> <span class="mi">2</span>

<span class="c1"># range string</span>
    <span class="s2">&quot;pixel&quot;</span><span class="p">:</span> <span class="s2">&quot;4-6&quot;</span>

<span class="c1"># list</span>
    <span class="s2">&quot;pixel&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="mi">2</span><span class="p">,</span>      <span class="c1"># pixel 2</span>
        <span class="s2">&quot;4-6&quot;</span><span class="p">,</span>  <span class="c1"># pixels 4, 5 and 6</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="c1"># pixels 10, 11, 12, 13, and 14</span>
    <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="fade-on">
<h2><code class="docutils literal notranslate"><span class="pre">fade.on</span></code><a class="headerlink" href="#fade-on" title="Permalink to this headline">¶</a></h2>
<p>Same as <code class="docutils literal notranslate"><span class="pre">on</span></code> animation, but fades each pixel from its current color to fully
on. By providing the optional argument <code class="docutils literal notranslate"><span class="pre">duration</span></code> you can specify the length
of the animation in fractional seconds, the step for each channel and frame
length will be adjusted to fit the animation into the specified amount of time.
If <code class="docutils literal notranslate"><span class="pre">duration</span></code> is not provided the animation will run with a frame count equal
to the largest difference for any color channel in the entire array and the
minimum frame length.</p>
</div>
<div class="section" id="fade-off">
<h2><code class="docutils literal notranslate"><span class="pre">fade.off</span></code><a class="headerlink" href="#fade-off" title="Permalink to this headline">¶</a></h2>
<p>Same as <code class="docutils literal notranslate"><span class="pre">off</span></code> animation but fades each pixel from its current color to fully
off. See the <cite>duration</cite> argument in <code class="docutils literal notranslate"><span class="pre">fade.on</span></code>.</p>
</div>
<div class="section" id="fade-brightness">
<h2><code class="docutils literal notranslate"><span class="pre">fade.brightness</span></code><a class="headerlink" href="#fade-brightness" title="Permalink to this headline">¶</a></h2>
<p>This animation is the same as <code class="docutils literal notranslate"><span class="pre">set.brightness</span></code> but will fade the brightness
to the new value. See the <code class="docutils literal notranslate"><span class="pre">duration</span></code> argument in <code class="docutils literal notranslate"><span class="pre">fade.on</span></code>.</p>
</div>
<div class="section" id="fade-array">
<h2><code class="docutils literal notranslate"><span class="pre">fade.array</span></code><a class="headerlink" href="#fade-array" title="Permalink to this headline">¶</a></h2>
<p>This sets a new color for the entire array, the same as <code class="docutils literal notranslate"><span class="pre">set.array</span></code>, but will
fade each pixel from its current color to the new one. See the <code class="docutils literal notranslate"><span class="pre">duration</span></code>
argument in <code class="docutils literal notranslate"><span class="pre">fade.on</span></code>.</p>
</div>
<div class="section" id="fade-pixel">
<h2><code class="docutils literal notranslate"><span class="pre">fade.pixel</span></code><a class="headerlink" href="#fade-pixel" title="Permalink to this headline">¶</a></h2>
<p>This sets a new color for the specified pixels, the same as <code class="docutils literal notranslate"><span class="pre">set.pixel</span></code>, but
will fade each pixel from its current color to the new one. See the
<code class="docutils literal notranslate"><span class="pre">duration</span></code> argument in <code class="docutils literal notranslate"><span class="pre">fade.on</span></code>.</p>
</div>
<div class="section" id="test-order">
<h2><code class="docutils literal notranslate"><span class="pre">test.order</span></code><a class="headerlink" href="#test-order" title="Permalink to this headline">¶</a></h2>
<p>This animation is used to help determine the byte order for the colors used by
your LEDs. To use it, set your <code class="docutils literal notranslate"><span class="pre">color</span> <span class="pre">order</span></code> to <code class="docutils literal notranslate"><span class="pre">'RGBW'</span></code> and trigger this
animation via MQTT. It will turn on 10 pixels, if the color order is actually
RGBW you will see one red, two green, three blue, and four white. If this is
not what you see, then the number of pixels of each color tell you where in
the color order that color goes.</p>
<p>Ex. If you have 1 green, 2 red, and 3 blue pixels on, then the color order is
GRB.</p>
</div>
<div class="section" id="test-array">
<h2><code class="docutils literal notranslate"><span class="pre">test.array</span></code><a class="headerlink" href="#test-array" title="Permalink to this headline">¶</a></h2>
<p>This is an animation used to test the entire array. It draws a rainbow across
the entire array and slides the colors along the array. It then quickly fades
on then off the white channel, if present.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># fade white up then down</span>
<span class="n">j</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">array</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="mi">255</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">cancel</span><span class="o">.</span><span class="n">is_set</span><span class="p">()</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
        <span class="n">array</span><span class="o">.</span><span class="n">setPixelColorRGB</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="n">array</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">+=</span> <span class="n">step</span>
    <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">32</span><span class="p">:</span> <span class="n">step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">array</span><span class="o">.</span><span class="n">anims</span><span class="p">[</span><span class="s2">&quot;off&quot;</span><span class="p">](</span><span class="n">array</span><span class="p">,</span> <span class="n">cancel</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above excerpt we can see that each step is checking if
<code class="docutils literal notranslate"><span class="pre">cancel.is_set()</span></code>. If you have an animation that is not a single step like
the <code class="docutils literal notranslate"><span class="pre">on</span></code> or <code class="docutils literal notranslate"><span class="pre">off</span></code> animations, you need to check for it being cancelled. If
<code class="docutils literal notranslate"><span class="pre">cancel.is_set()</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code>, your animation should stop what it is
doing and return.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="custom.html" class="btn btn-neutral float-right" title="Custom" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../animations.html" class="btn btn-neutral float-left" title="Animations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MQTTany Contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>